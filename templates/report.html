{% extends "master.html" %}

{% block title %}{{report.versions[0].title}}{% endblock %}

{% block body %}

<h1>{{report.versions[0].title}}</h1>

<p class="report-metadata">
    {{report.number}}
    {% if report.versions[-1].date != report.versions[0].date %}{{report.versions[-1].date|date}}&ndash;{% endif %}{{report.versions[0].date|date}}
</p>

<div class="row">
    <div class="col-sm-8">
        {% for format in report.versions[0].formats %}
             {% if format.format == "PDF" %}
                 <div id="download-link">
                     <a href="/{{format.filename}}" class="btn btn-success">Download {{format.format}}</a>
                 </div>
             {% endif %}
        {% endfor %}

        <div class="report-summary">{{report.versions[0].summary|format_summary|safe}}</div>

        <p class="report-authors">Author(s): {% for author in report.versions[0].authors %}{{author}}{% if not loop.last %}, {% endif %}{% endfor %}</p>
    </div> <!-- /col -->

    <div class="col-sm-4">
    <div id="sidebar-metadata">
       <div class="panel panel-default">
       <div class="panel-heading">Revision History</div>
       <div class="panel-body">
           <table id="report-versions">
           {% for version in report.versions %}
           <tr>
               <td class="report-version-date">{{version.date|date}}</td>
               <td class="report-formats">
                   {% for format in version.formats %}
                       <a href="/{{format.filename}}">{{format.format}}</a>
                   {% endfor %}
               </td>
               {% if 'percent_change' in version %}
               <td class="report-changes">
                   ({% if version.percent_change > 0 %}{{version.percent_change}}% changed{% else %}no change{% endif %})
               </td>
               {% endif %}
           </tr>
           {% endfor %}
           </table>
       </div>
       </div>

       <div class="panel panel-default">
       <div class="panel-heading">Metadata</div>
       <div class="panel-body">
           {# display the topics of the most recent version #}
           {% if report.versions[0].topics|length > 0 %}
           <div id="topics">
               <p class="heading">Topic areas</p>
               {% for topic in report.versions[0].topics %}
                  <p>{{topic.name}}</p>
               {% endfor %}
           </div>
           {% endif %}
           <p class="report-metadata"><a href="{{report.number}}.json">JSON</a></p>
       </div>
       </div>
    </div>
    </div> <!-- /col -->

</div> <!-- /row -->

<div class="row">
    <div class="col-sm-8">
        {% if html %}
            <hr>
            {{html|safe}}
        {% endif %}
    </div> <!-- /col -->
</div> <!-- /row -->

{% endblock %}
